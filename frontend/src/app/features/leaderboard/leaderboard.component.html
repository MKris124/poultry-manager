<div class="layout-content" style="max-width: 1200px; margin: 40px auto; padding: 0 20px;">

    <div class="flex flex-column md:flex-row justify-content-between align-items-center mb-5 gap-4">
        
        <div class="flex align-items-center gap-3">
            <div class="bg-yellow-500 text-white border-round p-3 shadow-4">
                <i class="pi pi-star-fill text-4xl"></i>
            </div>
            <div>
                <h1 class="font-bold m-0 text-3xl">Termelői ranglista</h1>
                <p class="text-500 mt-2">Rangsorolás a teljesítmény pontszáma alapján</p>
            </div>
        </div>

        <div class="flex align-items-center gap-3 w-full md:w-auto">
            <span class="relative block flex-1" style="min-width: 250px; max-width: 50rem;">
                <i class="pi pi-search text-500 absolute" 
                   style="top: 50%; transform: translateY(-50%); left: 1rem; z-index: 1;">
                </i>

                
            
                <input type="text" 
                       pInputText 
                       placeholder="Keresés..." 
                       (input)="dt.filterGlobal($any($event.target).value, 'contains')" 
                       class="w-full border-round-2xl surface-card border-none shadow-1 py-2 pl-6" 
                       style="padding-left: 3rem !important;"/> 
            </span>
            
            <button pButton icon="pi pi-arrow-left" 
                    routerLink="/partners" 
                    class="p-button-outlined border-round-2xl"
                    pTooltip="Vissza a partnerekhez">
            </button>
        </div>
    </div>

    <div class="modern-card overflow-hidden">
        <p-table #dt [value]="rankedPartners" 
                 styleClass="p-datatable-lg" 
                 [rowHover]="true"
                 [globalFilterFields]="['partnerName']"
                 selectionMode="single">
            
            <ng-template pTemplate="header">
                <tr>
                    <th style="width: 4rem" class="text-center">#</th>
                    <th style="width: 30%">Név</th>
                    
                    <th class="text-right text-500 font-normal">Máj (kg)</th>
                    <th class="text-right text-500 font-normal">Kóser %</th>
                    <th class="text-right text-500 font-normal">Elhullás %</th>

                    <th class="text-right text-primary text-xl" style="width: 150px">
                        PONTSZÁM
                    </th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-partner>
                <tr [pSelectableRow]="partner" (click)="openPartnerStats(partner)">
                    
                    <td class="text-center text-2xl">
                        {{ getMedal(partner.originalRank) }}
                    </td>
                    
                    <td>
                        <div class="font-bold text-xl">{{ partner.partnerName }}</div>
                    </td>
                    
                    <td class="text-right text-lg">
                        {{ partner.avgLiverWeight | number:'1.2-2' }}
                    </td>
                    <td class="text-right text-lg">
                        {{ partner.avgKosherPercent | number:'1.1-1' }}%
                    </td>
                    <td class="text-right text-lg text-500">
                        {{ partner.avgMortalityRate | number:'1.2-2' }}%
                    </td>

                    <td class="text-right">
                        <div class="font-black text-3xl text-primary">
                            {{ partner.totalScore | number:'1.0-2' }}
                        </div>
                    </td>

                </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="6" class="text-center p-5 text-500">
                        Nincs találat a keresési feltételeknek megfelelően.
                    </td>
                </tr>
            </ng-template>

        </p-table>
    </div>
    
    <div class="text-center mt-4 text-500 text-sm">
        <i class="pi pi-info-circle mr-1"></i>
        Pontszámítás: ((Kóser % × 5) + (Máj dkg × 4)) × (1 + (5% - Elhullás %) × 0,025)
    </div>

</div>

<app-partner-sidebar 
    [(visible)]="sidebarVisible" 
    [partner]="selectedPartner"
    [readOnly]="true"
    [disableSidebarAnim]="disableSidebarAnim"
    (closed)="onSidebarHide()"> 
</app-partner-sidebar>